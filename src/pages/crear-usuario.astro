---
import "../styles/global.css";
const evento = async (event: any) => {
    const datos = {'uid': 'a3:6b:a6:1a'};
    const uidDiv = document.getElementById("uid");
    const socketUrl = "http://" + window.location.host + "/ws"; 
    const response = await fetch(socketUrl, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify({ uid }),
 });

}

/*const handleSubmit = async (event) => {
  event.preventDefault();
 // const nombre = document.getElementById("nombre").value;

  
 const reponse=
  if (response.) {
    alert("Usuario creado con √©xito");
  } else {
    alert("Error al crear usuario");
  }
};*/

---
<html>
  <head>
    <title>Crear Usuario</title>
  </head>
  <body class="flex items-center justify-center min-h-screen bg-gray-100">
    <form onsubmit="evento(event)" class="bg-white p-6 rounded shadow-md w-80">
      <form onsubmit="evento(event)" class="bg-white p-6 rounded shadow-md w-80">
        <label for="uid" class="block text-gray-700">UID:</label>
        <input
          type="text"
          id="uid"
          name="uid"
          readonly
          class="w-full px-3 py-2 border border-gray-300 rounded mb-4 bg-gray-100"
        />

      <label for="nombre" class="block text-gray-700 mb-2">Nombre:</label>
      <input
        type="text"
        id="nombre"
        name="nombre"
        required
        class="w-full px-3 py-2 border border-gray-300 rounded mb-4"
      />

      <button
        type="submit"
        class="w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600"
      >
        Guardar
      </button>
    </form>
    <script type="module">
      let socket;

      window.addEventListener("DOMContentLoaded", () => {
        const uidInput = document.getElementById("uid");
        socket = new WebSocket("ws://" + window.location.host + "/ws");

        socket.onopen = () => {
          console.log("‚úÖ WebSocket conectado");
        };

        socket.onmessage = (event) => {
          console.log("üì• UID recibido:", event.data);
          uidInput.value = event.data;
        };

        socket.onerror = (error) => {
          console.error("‚ùå Error WebSocket:", error);
        };
      });

      document.getElementById("formulario").addEventListener("submit", async (event) => {
        event.preventDefault();

        const uid = document.getElementById("uid").value;
        const nombre = document.getElementById("nombre").value;

        if (!uid) {
          alert("‚ö†Ô∏è UID no disponible.");
          return;
        }

        if (socket && socket.readyState === WebSocket.OPEN) {
          socket.send(JSON.stringify({ uid, nombre }));
          alert("‚úÖ Datos enviados por WebSocket");
        } else {
          alert("‚ùå WebSocket no est√° conectado.");
        }
      });
    </script>
  </body>
</html>
